<h2>Permit Request</h2>
<app-progress-bar></app-progress-bar>
<div class="confirm-pay-bg" *ngIf="showConfirmation" (click)="onCancelPayment()"> </div>
<dialog class="confirm-pay" *ngIf="showConfirmation">
    @if (!showFailedPayment) {
        <h2>Are you sure you want to pay {{getExcavationDetails().price}}$?</h2>
        <img src="assets/sack-dollar-solid.svg" alt="cash">
        <div class="control-buttons">
            <input type="button" value="Cancel" class="cancel" (click)="onCancelPayment()">
            <a routerLink="/request-review">
            <input type="submit" value="Confirm" class="confirm" (click)="onConfirmPayment()">
            </a>
        </div>
    }
    @else {
        <h2 class="failed-payment">Payment Failed!</h2>
        <h2>You don't have enough balance to complete this transaction!</h2>
        <div class="control-buttons">
            <input type="button" value="Close" class="cancel" (click)="onCancelPayment()">
        </div>
    }

</dialog>
<div class="payment-main">
    <div class="payment-header">
        <div>
            <img src="assets/credit-card-solid.svg" alt="Invoice">
        </div>
        <h2>Invoice</h2>
    </div>

    <div class="errors">
        <!-- @if (!excavationDataForm.valid) {
            <img src="assets/warning.svg" alt="error">
            <small>Please Fill All Required Fields</small>
        } -->
    </div>
    <div class="invoice-details"> 
        <h3>User Details</h3>
        <div class="invoice-user-details">
            <p>Name: <span>{{getUserDetails().name}}</span></p>
            <p>Phone: <span>{{getUserDetails().phone}}</span></p>
            <p>Balance: <span>{{getUserDetails().balance}}$</span></p>
        </div>
        <h3>Excavation Details</h3>
        <div class="excavation-invoice-details">
            <div>
                <p>Project: <span>{{getProjectDetails().projectName}}</span></p>
            </div>
            <div>
                <p>Excavation Method: <span>{{getExcavationDetails().excavationMethod}}</span></p>
                <p>Excavation Type: <span>{{getExcavationDetails().excavationType}}</span></p>
                <p>Excavation Duration: <span>{{getExcavationDetails().excavationDuration}}</span></p>
            </div>
            <div>
                <p>Street: <span>{{getExcavationDetails().excavationLocation.street}}</span></p>
                <p>Area: <span>{{getExcavationDetails().excavationLocation.area}}</span></p>
                <p>City: <span>{{getExcavationDetails().excavationLocation.city}}</span></p>
            </div>

        </div>
        <h3>Payment Details</h3>
        <div class="invoice-pay-details">
            <p>Payment Method: <span>{{getUserDetails().paymentMethod}}</span></p>
            <p>Price: <span>{{getExcavationDetails().price}}$</span></p>
        </div>
    </div>

    <div class="control-buttons">
        <div class="control-buttons-left">
            <a routerLink="/excavation-data"><input type="button" value="Prev" id="prev"></a>
        </div>
        <div class="control-buttons-right">
            <a routerLink="/permit"><input type="button" value="Cancel" class="cancel" (click)="onCancel()"></a>

           <a><input type="submit" value="Next" class="confirm" (click)="onSubmit()"></a> 
        </div>


    </div>
</div>

